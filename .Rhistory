agg = aggregate(residual~Yr+Name,d,mean)
#combine
idd = paste0(agg[,2])
yall = 1:length(idd)
iall = levels(factor(idd))
yrs = agg[,1]
for(j in 1:length(scenarios)){
ds = d[d$scenario==scenarios[j],]
jdd = paste0(ds$Yr,".",ds$Name)
yj = which(idd %in% jdd)
ylim = c(-max(abs(d$residual)),max(abs(d$residual)))
plot(yall,yall,type="n",xlab="Year",xlim=c(1,max(yall)),ylim=ylim,axes=F,xaxs = "i",yaxs="i")
axis(1,at=yall,labels=yrs,cex.axis=0.6,mgp=c(0.1,0.,0))
axis(2,cex.axis=0.6,mgp=c(0.5,0.0,0))
title(main=paste(ds$scenario)[1], mgp=c(0.1,0,0),cex.main=0.8,line=0.2)
abline(v=1)
#for(i in 1:length(indices)){}
i = 1
ni = length(unique(ds$Name))
indices = levels(factor(ds$Name))
for(i in 1:ni){
di = ds[ds$Name==indices[i],]
yi = yall[which(agg$Name==indices[i])]
get_runs = runs.sig3(di$residual)
lims = get_runs$sig3lim
polygon(c(yi,rev(yi)),c(rep(ylim[1],nrow(di)),rev(rep(ylim[2],nrow(di)))),col=ifelse(get_runs$p.runs<0.05,rgb(1,0,0,0.5),rgb(0,1,0,0.5)),border=0)
polygon(c(yi,rev(yi)),c(rep(lims[1],nrow(di)),rev(rep(lims[2],nrow(di)))),col=grey(0.5,0.5),border=0)
lines(yi,di$residual)
points(yi,di$residual,pch=21,bg=ifelse(abs(di$residual)>abs(lims[1]),2,0),cex=0.7)
text(mean(yi),ylim[2]*0.9,which(indices[i]==iall),cex=0.8)
}
if(j==1){  legend(par('usr')[2], par('usr')[4]-1, bty='n', xpd=NA,
c(paste0(1:length(iall),": ",iall)),cex=0.7)}
if(j==1){legend(par('usr')[2]+2, par('usr')[4], bty='n', xpd=NA,
c("Passed","Failed"),pch=15,col=c(rgb(0,1,0,0.5),rgb(1,0,0,0.5)),pt.cex=2,cex=0.7)}
abline(h=0,lty=2)
abline(h=max(abs(d$residual)))
for(i in 1:length(iall)){
abline(v=0.5+max(which(agg$Name==levels(factor(agg$Name))[i])))
}
mtext(paste("Years"), side=1, outer=TRUE, at=0.5,line=-0.3,cex=.8)
mtext(paste("Std. Residuals"), side=2, outer=TRUE, at=0.5,line=-0.3,cex=0.8)
}
devtools::load_all("~/GitHub/ssdiags")
## generate and/or load SS output object
setwd("C:/Users/mkapur/Dropbox/UW/coursework/FISH-555/Model_162")
# MLS<-SS_output(dir="C:/Users/mkapur/Dropbox/UW/coursework/FISH-555/Model_162",covar=FALSE, forecast = FALSE)
# save(MLS,file="MLS.rdata")
load("MLS.rdata",verbose=T)
basename(MLS)
getwd()
## generate and/or load SS output object
setwd("C:/Users/mkapur/Dropbox/UW/coursework/FISH-555")
wd <- paste0(getwd(),"/R0_profile/")
if(!exists(wd)) dir.create(wd)
install.packages('foreach','doSNOW')
library('foreach')
library('doSNOW')
install.packages("doSNOW")
library('doSNOW')
# library('foreach')
#library('doMC') # Comment out for windows
# library('doSNOW') # Uncomment for Windows
# setwd("C:/Users/felip/Dropbox/MLS_2019_1994/R0_profile")
parm.min <- 4.5
parm.max <-6.5
parm.step <- 0.1
getwd()
setwd(wd)
parmstr.parfile <- '# SR_parm\\[1]:' # Note that you need to add double backslash for escape character for grep
parfile <- 'ss.par'
ssdir.orig <- 'orig'
numcpus <- 4
#runss.str <- './SS324ab.bin -nohess -nox' # Comment out for windows
runss.str <- 'ss.exe -nohess -nox' # Uncomment for Windows
origwd <- getwd()
parm.vec <- seq(parm.min, parm.max, parm.step)
numdir <- length(parm.vec)
for (ii in 1:numdir) {
dir.name <- paste(sprintf('%02d',ii),sprintf('%.2f',parm.vec[ii]),sep='_')
#	system(paste('cp -r', ssdir.orig, dir.name, sep=' ')) # Comment out for windows
system(paste('xcopy ', ssdir.orig, ' ', dir.name, '\\* ', '/E', sep='')) # Uncomment for Windows
parfile.infile <- paste(dir.name,'/',parfile, sep='')
conn <- file(parfile.infile, open='r')
parfile.intxt <- readLines(conn)
close(conn)
parfile.outtxt <- parfile.intxt
wantedline <- grep(parmstr.parfile,parfile.intxt)
parfile.outtxt[wantedline+1] <-  parm.vec[ii]
conn <- file(parfile.infile, open='w')
writeLines(parfile.outtxt, conn)
close(conn)
}
paste(dir.name,'/',parfile, sep='')
ii
dir.name
numdir
sprintf('%02d',ii)
dir.name <- paste(sprintf('%02d',ii),sprintf('%.2f',parm.vec[ii]),sep='_')
#	system(paste('cp -r', ssdir.orig, dir.name, sep=' ')) # Comment out for windows
system(paste('xcopy ', ssdir.orig, ' ', dir.name, '\\* ', '/E', sep='')) # Uncomment for Windows
ssdir.orig
rm(list = ls())
wd <- paste0(getwd(),"/R0_profile/")
if(!exists(wd)) dir.create(wd)
setwd(wd)
parmstr.parfile <- '# SR_parm\\[1]:' # Note that you need to add double backslash for escape character for grep
parfile <- 'ss.par'
ssdir.orig <- 'orig'
numcpus <- 4
#runss.str <- './SS324ab.bin -nohess -nox' # Comment out for windows
runss.str <- 'ss.exe -nohess -nox' # Uncomment for Windows
moddir <- "C:/Users/mkapur/Dropbox/UW/coursework/FISH-555/Workshop/SuperSimpleClean"
#	system(paste('cp -r', ssdir.orig, dir.name, sep=' ')) # Comment out for windows
system(paste('xcopy ', ssdir.orig, ' ', dir.name, '\\* ', '/E', sep='')) # Uncomment for Windows
origwd <- moddir
dir.name <- paste(sprintf('%02d',ii),sprintf('%.2f',parm.vec[ii]),sep='_')
ii = 1
dir.name <- paste(sprintf('%02d',ii),sprintf('%.2f',parm.vec[ii]),sep='_')
#	system(paste('cp -r', ssdir.orig, dir.name, sep=' ')) # Comment out for windows
system(paste('xcopy ', ssdir.orig, ' ', dir.name, '\\* ', '/E', sep='')) # Uncomment for Windows
origwd <- moddir
parm.vec <- seq(parm.min, parm.max, parm.step)
numdir <- length(parm.vec)
parm.min = 4.5
parm.max = 6.5
parm.step = 0.1
parm.vec <- seq(parm.min, parm.max, parm.step)
numdir <- length(parm.vec)
dir.name <- paste(sprintf('%02d',ii),sprintf('%.2f',parm.vec[ii]),sep='_')
#	system(paste('cp -r', ssdir.orig, dir.name, sep=' ')) # Comment out for windows
system(paste('xcopy ', ssdir.orig, ' ', dir.name, '\\* ', '/E', sep='')) # Uncomment for Windows
paste('xcopy ', ssdir.orig, ' ', dir.name, '\\* ', '/E', sep=''))
paste('xcopy ', ssdir.orig, ' ', dir.name, '\\* ', '/E', sep='')
r4ss
?r4ss
SS_profile(dir=mydir, # directory
# "NatM" is a subset of one of the
# parameter labels in control.ss_new
model="ss",
masterctlfile="control.ss_new",
newctlfile="control_modified.ss",
string="steep",
profilevec=h.vec)
head(df2)
df <- read.csv("C:/Users/mkapur/Dropbox/UW/coursework/FISH-555/workshop/hw1_agevals.csv")
df2 <-  read.csv("C:/Users/mkapur/Dropbox/UW/coursework/FISH-555/workshop/hw1_refpoints.csv")
head(df)
df2 <-  read.csv("C:/Users/mkapur/Dropbox/UW/coursework/FISH-555/homework/hw1_refpoints.csv")
df <- read.csv("C:/Users/mkapur/Dropbox/UW/coursework/FISH-555/homework/hw1_agevals.csv")
head(df)
df <- read.csv("C:/Users/mkapur/Dropbox/UW/coursework/FISH-555/homework/hw1_agevals.csv")
head(df2)
head(df)
## 1 Plot vulnerability and maturity at age
ggplot(df2, aes(x =age)) +
theme_minimal()+
geom_line(lwd = 1.1, aes(y = vuln_F0)) +
geom_line(lwd = 1.1, aes(y =mat ))
## KAPURM@UW.EDU
## FISH 555 SP 2019
## Homework 1 -- simple ASM with Striped Marlin Inputs
## Note: original steepness is 0.87
require(ggplot2)
labs(x = 'Age', y = '', title = 'Selectivity and Maturity at Age')
## 1 Plot vulnerability and maturity at age
ggplot(df2, aes(x =age)) +
theme_minimal()+
geom_line(lwd = 1.1, aes(y = vuln_F0)) +
geom_line(lwd = 1.1, aes(y =mat ))+
labs(x = 'Age', y = '', title = 'Selectivity and Maturity at Age')
head(df2)
head(df)
## 1 Plot vulnerability and maturity at age
ggplot(df, aes(x =age)) +
theme_minimal()+
geom_line(lwd = 1.1, aes(y = vuln_F0)) +
geom_line(lwd = 1.1, aes(y =mat ))+
labs(x = 'Age', y = '', title = 'Selectivity and Maturity at Age')
require(reshape2)
require(dplyr)
df %>% select(age, vuln_F0, mat) %>% melt(., id = c('age'))
## 1 Plot vulnerability and maturity at age
df %>% select(age, vuln_F0, mat) %>% melt(., id = c('age')) %>%
ggplot(df, aes(x =age,y = value, color = variable)) +
theme_minimal()+
geom_line(lwd = 1.1)+
labs(x = 'Age', y = '', title = 'Selectivity and Maturity at Age')
## 1 Plot vulnerability and maturity at age
df %>% select(age, vuln_F0, mat) %>% melt(., id = c('age')) %>%
ggplot(df, aes(x =age,y = value, color = variable)) +
theme_minimal() +
geom_line(lwd = 1.1) +
labs(x = 'Age', y = '', title = 'Selectivity and Maturity at Age')
## 1 Plot vulnerability and maturity at age
df %>% select(age, vuln_F0, mat) %>% melt(., id = c('age')) %>%
ggplot(., aes(x =age,y = value, color = variable)) +
theme_minimal() +
geom_line(lwd = 1.1) +
labs(x = 'Age', y = '', title = 'Selectivity and Maturity at Age')
require(ggplot2)
require(reshape2)
require(dplyr)
df <- read.csv("C:/Users/mkapur/Dropbox/UW/coursework/FISH-555/homework/hw1_agevals.csv")
df2 <-  read.csv("C:/Users/mkapur/Dropbox/UW/coursework/FISH-555/homework/hw1_refpoints.csv")
head(df)
head(df2)
df %>% select(age, vuln_F0, mat) %>% melt(., id = c('age')) %>%
ggplot(., aes(x =age,y = value, color = variable)) +
theme_minimal() +
geom_line(lwd = 1.1) +
labs(x = 'Age', y = '', title = 'Selectivity and Maturity at Age')
head(df)
df %>% select(age, vuln_F0, mat) %>% plyr::rename(c('vuln_F0' = 'vulnerability','mat' = 'maturity')) %>% melt(., id = c('age')) %>%
ggplot(., aes(x =age,y = value, color = variable)) +
theme_minimal() +
geom_line(lwd = 1.1) +
labs(x = 'Age', y = '', title = 'Selectivity and Maturity at Age')
df %>% select(age, vuln_F0, mat) %>% plyr::rename(c('vuln_F0' = 'vulnerability','mat' = 'maturity')) %>% melt(., id = c('age')) %>%
ggplot(., aes(x =age,y = value, color = variable)) +
theme_minimal() +
theme(legend.position = c(0.9,0.1)) +
geom_line(lwd = 1.1) +
labs(x = 'Age', y = '', color = '', title = 'Selectivity and Maturity at Age')
df %>% select(age, vuln_F0, mat) %>% plyr::rename(c('vuln_F0' = 'vulnerability','mat' = 'maturity')) %>% melt(., id = c('age')) %>%
ggplot(., aes(x =age,y = value, color = variable)) +
theme_minimal() +
theme(legend.position = c(0.9,0.2)) +
geom_line(lwd = 1.1) +
labs(x = 'Age', y = '', color = '', title = 'Selectivity and Maturity at Age')
head(df)
df %>% select(age, numbers_F0, numbers_f01) %>% plyr::rename(c('numbers_f01' = 'Numbers_F0.1','numbers_F0' = 'Numbers_F0')) %>% melt(., id = c('age')) %>%
ggplot(., aes(x =age,y = value, color = variable)) +
theme_minimal() +
theme(legend.position = c(0.9,0.2)) +
geom_line(lwd = 1.1) +
labs(x = 'Age', y = '', color = '', title = 'Selectivity and Maturity at Age')
df %>% select(age, numbers_F0, numbers_f01) %>% plyr::rename(c('numbers_f01' = 'Numbers_F0.1','numbers_F0' = 'Unfished')) %>% melt(., id = c('age')) %>%
ggplot(., aes(x =age,y = value, color = variable)) +
theme_minimal() +
theme(legend.position = c(0.9,0.8)) +
geom_line(lwd = 1.1) +
labs(x = 'Age', y = '', color = '', title = 'Numbers at Age at Unfished and F = 0.1')
head(df)
ggplot(df, aes(x =age,y = cohort_weight)) +
theme_minimal() +
theme(legend.position = c(0.9,0.8)) +
geom_line(lwd = 1.1) +
labs(x = 'Age', y = 'Cohort Weight' title = 'Cohort Weight at Age')
ggplot(df, aes(x =age,y = cohort_weight)) +
theme_minimal() +
theme(legend.position = c(0.9,0.8)) +
geom_line(lwd = 1.1) +
labs(x = 'Age', y = 'Cohort Weight',title = 'Cohort Weight at Age')
df %>% select(age, mort, cohort_weight) %>% plyr::rename(c('mort' = 'Natural Mortality','cohort_weight' = 'Somatic Growth')) %>% melt(., id = c('age')) %>%
ggplot(., aes(x =age,y = value, color = variable)) +
theme_minimal() +
theme(legend.position = c(0.9,0.8)) +
geom_line(lwd = 1.1) +
labs(x = 'Age', y = '', color = '', title = 'Numbers at Age at Unfished and F = 0.1')
head(df2)
ggplot(df,aes(x = HRATE,y = YPR)) +
theme_minimal()+
geom_line(lwd = 1.1) +
geom_vline(xintercept = df$HRATE[18], linetype = 'dashed', col = 'red', lwd = 1.1) +
labs(x = 'Harvest Rate', y = 'Yield per Recruit', title = 'YPR vs H -- dashed line is F0.1')
ggplot(df2,aes(x = HRATE,y = YPR)) +
theme_minimal()+
geom_line(lwd = 1.1) +
geom_vline(xintercept = df$HRATE[18], linetype = 'dashed', col = 'red', lwd = 1.1) +
labs(x = 'Harvest Rate', y = 'Yield per Recruit', title = 'YPR vs H -- dashed line is F0.1')
ggplot(df2,aes(x = HRATE,y = YPR)) +
theme_minimal()+
geom_line(lwd = 1.1) +
# geom_vline(xintercept = df$HRATE[18], linetype = 'dashed', col = 'red', lwd = 1.1) +
labs(x = 'Harvest Rate', y = 'Yield per Recruit', title = 'YPR vs H -- dashed line is F0.1')
ggplot(df2,aes(x = HRATE,y = YPR)) +
theme_minimal()+
geom_line(lwd = 1.1) +
geom_vline(xintercept = df2$HRATE[18], linetype = 'dashed', col = 'red', lwd = 1.1) +
labs(x = 'Harvest Rate', y = 'Yield per Recruit', title = 'YPR vs H -- dashed line is F0.1')
df2$YRP[which.max(df2$YPR)]
df2$YPR[which.max(df2$YPR)]
df2$HRATE[which.max(df2$YPR)]
ggplot(df2,aes(x = HRATE,y = YPR)) +
theme_minimal()+
geom_line(lwd = 1.1) +
geom_vline(xintercept =  df2$HRATE[which.max(df2$YPR)], linetype = 'dashed', col = 'red', lwd = 1.1) +
labs(x = 'Harvest Rate', y = 'Yield per Recruit', title = 'YPR vs H -- dashed line is F0.1')
ggplot(df2,aes(x = HRATE,y = YPR)) +
theme_minimal()+
geom_line(lwd = 1.1) +
geom_vline(xintercept =  df2$HRATE[18], linetype = 'dashed', col = 'red', lwd = 1.1) +
labs(x = 'Harvest Rate', y = 'Yield per Recruit', title = 'YPR vs H -- dashed line is F0.1')
ggplot(df2,aes(x = HRATE,y = YPR)) +
theme_minimal()+
geom_line(lwd = 1.1) +
geom_vline(xintercept =  df2$HRATE[18], linetype = 'dashed', col = 'red', lwd = 1.1) +
annotate('text', x =  df2$HRATE[18], y = 10, label = 'F0.1') +
labs(x = 'Harvest Rate', y = 'Yield per Recruit', title = 'YPR vs H -- dashed line is F0.1')
ggplot(df2,aes(x = HRATE,y = YPR)) +
theme_minimal()+
geom_line(lwd = 1.1) +
geom_vline(xintercept =  df2$HRATE[18], linetype = 'dashed', col = 'red', lwd = 1.1) +
annotate('text', x =  df2$HRATE[18]*1.1, y = 10, label = 'F0.1') +
labs(x = 'Harvest Rate', y = 'Yield per Recruit', title = 'YPR vs H -- dashed line is F0.1')
ggplot(df2,aes(x = HRATE,y = SBPR)) +
theme_minimal()+
geom_line(lwd = 1.1) +
geom_vline(xintercept =  df2$HRATE[18], linetype = 'dashed', col = 'red', lwd = 1.1) +
# annotate('text', x =  df2$HRATE[18]*1.1, y = 10, label = 'F0.1') +
labs(x = 'Harvest Rate', y = 'SBPR', title = 'SBPR vs H -- dashed line is F0.1')
ggplot(df2,aes(x = HRATE,y = SBPR)) +
theme_minimal()+
geom_line(lwd = 1.1) +
# geom_vline(xintercept =  df2$HRATE[18], linetype = 'dashed', col = 'red', lwd = 1.1) +
# annotate('text', x =  df2$HRATE[18]*1.1, y = 10, label = 'F0.1') +
labs(x = 'Harvest Rate', y = 'SBPR', title = 'SBPR vs H -- dashed line is F0.1')
head(df2)
ggplot(df2,aes(x = HRATE,y = RELATIVE.SBPR..SCALED.TO.ONE)) +
theme_minimal()+
geom_line(lwd = 1.1) +
# geom_vline(xintercept =  df2$HRATE[18], linetype = 'dashed', col = 'red', lwd = 1.1) +
# annotate('text', x =  df2$HRATE[18]*1.1, y = 10, label = 'F0.1') +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
ggplot(df2,aes(x = HRATE,y = RELATIVE.SBPR..SCALED.TO.ONE)) +
theme_minimal()+
geom_line(lwd = 1.1) +
scale_y_continuous(limits = c(0,1)) +
# annotate('text', x =  df2$HRATE[18]*1.1, y = 10, label = 'F0.1') +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
df3 <- data.frame('SPBR 50%' = 0.18, 'SBPR 40%' = 0.26, 'SPR 30%' = 0.38)
df3
t(df3)
ggplot(df2,aes(x = HRATE,y = RELATIVE.SBPR..SCALED.TO.ONE)) +
theme_minimal()+
geom_line(lwd = 1.1) +
scale_y_continuous(limits = c(0,1)) +
geom_vline(xintercept = c(t(df3))) +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
ggplot(df2,aes(x = HRATE,y = RELATIVE.SBPR..SCALED.TO.ONE)) +
theme_minimal()+
geom_line(lwd = 1.1) +
scale_y_continuous(limits = c(0,1)) +
geom_vline(xintercept = c(t(df3)), lwd = 2, linetype = 'dashed') +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
ggplot(df2,aes(x = HRATE,y = RELATIVE.SBPR..SCALED.TO.ONE)) +
theme_minimal()+
geom_line(lwd = 1.1) +
scale_y_continuous(limits = c(0,1)) +
geom_vline(xintercept = c(t(df3)), lwd = 1.1, linetype = 'dashed') +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
?geom_segment
ggplot(df2,aes(x = HRATE,y = RELATIVE.SBPR..SCALED.TO.ONE)) +
theme_minimal()+
geom_line(lwd = 1.1) +
scale_y_continuous(limits = c(0,1)) +
geom_segment(x = c(t(df3)), xend = c(t(df3)), y = c(0,0,0), yend = c(0.5,0.4,0.3),  lwd = 1.1, linetype = 'dashed') +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
ggplot(df2,aes(x = HRATE,y = RELATIVE.SBPR..SCALED.TO.ONE)) +
theme_minimal()+
geom_line(lwd = 1.1) +
scale_y_continuous(limits = c(0,1)) +
geom_segment(data = NULL, x = c(t(df3)), xend = c(t(df3)), y = c(0,0,0), yend = c(0.5,0.4,0.3),  lwd = 1.1, linetype = 'dashed') +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
ggplot(df2,aes(x = HRATE,y = RELATIVE.SBPR..SCALED.TO.ONE)) +
theme_minimal()+
geom_line(lwd = 1.1) +
scale_y_continuous(limits = c(0,1)) +
geom_segment(data = df3, x = c(t(df3)), xend = c(t(df3)), y = c(0,0,0), yend = c(0.5,0.4,0.3),  lwd = 1.1, linetype = 'dashed') +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
ggplot(df2,aes(x = HRATE,y = RELATIVE.SBPR..SCALED.TO.ONE)) +
theme_minimal()+
geom_line(lwd = 1.1) +
scale_y_continuous(limits = c(0,1)) +
geom_segment(data = t(df3), x = c(t(df3)), xend = c(t(df3)), y = c(0,0,0), yend = c(0.5,0.4,0.3),  lwd = 1.1, linetype = 'dashed') +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
ggplot(df2,aes(x = HRATE,y = RELATIVE.SBPR..SCALED.TO.ONE)) +
theme_minimal()+
geom_line(lwd = 1.1) +
scale_y_continuous(limits = c(0,1)) +
geom_segment(data = data.frame(1,1,1), x = c(t(df3)), xend = c(t(df3)), y = c(0,0,0), yend = c(0.5,0.4,0.3),  lwd = 1.1, linetype = 'dashed') +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
ggplot(df2,aes(x = HRATE,y = RELATIVE.SBPR..SCALED.TO.ONE)) +
theme_minimal()+
geom_line(lwd = 1.1) +
scale_y_continuous(limits = c(0,1)) +
geom_segment(data = NULL, aes(x = c(t(df3)), xend = c(t(df3)), y = c(0,0,0), yend = c(0.5,0.4,0.3)),  lwd = 1.1, linetype = 'dashed') +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
ggplot(df2,aes(x = HRATE,y = RELATIVE.SBPR..SCALED.TO.ONE)) +
theme_minimal()+
geom_line(lwd = 1.1) +
scale_y_continuous(limits = c(0,1)) +
geom_segment(aes(x = c(t(df3)), xend = c(t(df3)), y = c(0,0,0), yend = c(0.5,0.4,0.3)),  lwd = 1.1, linetype = 'dashed') +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
ggplot(df2,aes(x = HRATE,y = RELATIVE.SBPR..SCALED.TO.ONE)) +
theme_minimal()+
geom_line(lwd = 1.1) +
scale_y_continuous(limits = c(0,1)) +
geom_segment(data = data.frame(1,1,1), aes(x = c(t(df3)), xend = c(t(df3)), y = c(0,0,0), yend = c(0.5,0.4,0.3)),  lwd = 1.1, linetype = 'dashed') +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
kable(df3)
??kable
require(data.table)
require(knitr)
kable(df3)
df4 <- data.frame(x1 = t(df3), x2 = t(df3), y1 = c(0,0,0),
y2 = c(0.5,0.4,0.3))
df4
ggplot(df2,aes(x = HRATE,y = RELATIVE.SBPR..SCALED.TO.ONE)) +
theme_minimal()+
geom_line(lwd = 1.1) +
scale_y_continuous(limits = c(0,1)) +
geom_segment(aes(x = x1, y = y1, xend = x2, yend = y2, colour = "segment"), data = df4) +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
geom_line(lwd = 1.1) +
scale_y_continuous(limits = c(0,1)) +
geom_segment(aes(x = x1, y = y1, xend = x2, yend = y2, colour = "segment"), data = df4, lwd = 1.1, col = 'red') +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
ggplot(df2,aes(x = HRATE,y = RELATIVE.SBPR..SCALED.TO.ONE)) +
theme_minimal()+
theme(legend.position = 'none') +
geom_line(lwd = 1.1) +
scale_y_continuous(limits = c(0,1)) +
geom_segment(aes(x = x1, y = y1, xend = x2, yend = y2, colour = "segment"), data = df4, lwd = 1.1, col = 'red') +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
ggplot(df2,aes(x = HRATE,y = RELATIVE.SBPR..SCALED.TO.ONE)) +
theme_minimal()+
theme(legend.position = 'none') +
geom_line(lwd = 1.1) +
scale_y_continuous(limits = c(0,1)) +
geom_segment(aes(x = x1, y = y1, xend = x2, yend = y2, colour = "segment"), data = df4, lwd = 1.1, col = 'red', type = 'dashed') +
labs(x = 'Harvest Rate', y = 'Rel SPR', title = 'Rel SPR vs H')
head(df)
head(df2)
df2 %>% select(HRATE, yield_h0.5, yield_h0.7,yield_h0.9) %>%
plyr::rename(c('HRATE' = 'Exploitation Rate',
'yield_h0.5' = 'Steepness_0.5',
'yield_h0.7' = 'Steepness_0.7','yield_h0.9' = 'Steepness_0.9')) %>% melt(., id = c('age')) %>%
ggplot(., aes(x =age,y = value, color = variable)) +
theme_minimal() +
theme(legend.position = c(0.9,0.8)) +
geom_line(lwd = 1.1) +
labs(x = 'Age', y = '', color = '', title = 'Yield at Various Steepness Values')
df2 %>% select(HRATE, yield_h0.5, yield_h0.7,yield_h0.9) %>%
plyr::rename(c('HRATE' ,
'yield_h0.5' = 'Steepness_0.5',
'yield_h0.7' = 'Steepness_0.7','yield_h0.9' = 'Steepness_0.9')) %>% melt(., id = c('age')) %>%
ggplot(., aes(x =HRATE,y = value, color = variable)) +
theme_minimal() +
theme(legend.position = c(0.9,0.8)) +
geom_line(lwd = 1.1) +
labs(x = 'Exploitation Rate', y = 'Yield', color = '', title = 'Yield vs H Rate at Various Steepness Values')
df2 %>% select(HRATE, yield_h0.5, yield_h0.7,yield_h0.9) %>%
plyr::rename(c('HRATE' ,
'yield_h0.5' = 'Steepness_0.5',
'yield_h0.7' = 'Steepness_0.7','yield_h0.9' = 'Steepness_0.9')) %>% melt(., id = c('HRATE')) %>%
ggplot(., aes(x =HRATE,y = value, color = variable)) +
theme_minimal() +
theme(legend.position = c(0.9,0.8)) +
geom_line(lwd = 1.1) +
labs(x = 'Exploitation Rate', y = 'Yield', color = '', title = 'Yield vs H Rate at Various Steepness Values')
df2 %>% select(HRATE, yield_h0.5, yield_h0.7,yield_h0.9) %>%
plyr::rename(c('HRATE' ,
'yield_h0.5' = 'Steepness_0.5',
'yield_h0.7' = 'Steepness_0.7','yield_h0.9' = 'Steepness_0.9')) %>% melt(., id = c('HRATE')) %>%
ggplot(., aes(x =HRATE,y = value, color = variable)) +
theme_minimal() +
theme(legend.position = c(0.7,0.8)) +
geom_line(lwd = 1.1) +
labs(x = 'Exploitation Rate', y = 'Yield', color = '', title = 'Yield vs H Rate at Various Steepness Values')
head(df2)
df2$HRATE[which.max(df2$yield_h0.5)]
df2$HRATE[which.max(df2$yield_h0.8)])
df5 <- data.frame('Fmsy' = c(df2$HRATE[which.max(df2$yield_h0.5)],
df2$HRATE[which.max(df2$yield_h0.7)],
df2$HRATE[which.max(df2$yield_h0.8)]))
df5
df5 <- data.frame('Fmsy' = c(df2$HRATE[which.max(df2$yield_h0.5)],
df2$HRATE[which.max(df2$yield_h0.7)],
df2$HRATE[which.max(df2$yield_h0.9)]))
df5
require(ggplot2)
require(reshape2)
require(dplyr)
require(knitr)
df <- read.csv("C:/Users/mkapur/Dropbox/UW/coursework/FISH-555/homework/hw1_agevals.csv")
df2 <-  read.csv("C:/Users/mkapur/Dropbox/UW/coursework/FISH-555/homework/hw1_refpoints.csv")
head(df)
head(df2)
df2$HRATE[df2$relspr_h0.5 > 0.39 & df2$relspr_h0.5 < 0.41]
df5 <- data.frame('Fmsy' = c(df2$HRATE[which.max(df2$yield_h0.5)],
df2$HRATE[which.max(df2$yield_h0.7)],
df2$HRATE[which.max(df2$yield_h0.9)]),
'FB40' = df2$HRATE[df2$relspr_h0.5 > 0.39 & df2$relspr_h0.5 < 0.41][1],
df2$HRATE[df2$relspr_h0.7 > 0.39 & df2$relspr_h0.7 < 0.41][1],
df2$HRATE[df2$relspr_h0.9 > 0.39 & df2$relspr_h0.9 < 0.41][1])
kable(df5)
df2$HRATE[df2$relspr_h0.7 > 0.39 & df2$relspr_h0.7 < 0.41][1]
data.frame('Fmsy' = c(df2$HRATE[which.max(df2$yield_h0.5)],
df2$HRATE[which.max(df2$yield_h0.7)],
df2$HRATE[which.max(df2$yield_h0.9)]),
'FB40' = c(df2$HRATE[df2$relspr_h0.5 > 0.39 & df2$relspr_h0.5 < 0.41][1],
df2$HRATE[df2$relspr_h0.7 > 0.39 & df2$relspr_h0.7 < 0.41][1],
df2$HRATE[df2$relspr_h0.9 > 0.39 & df2$relspr_h0.9 < 0.41][1]))
df2$HRATE[df2$relspr_h0.7 > 0.39 & df2$relspr_h0.7 < 0.41]
df5 <- data.frame('Fmsy' = c( df2$HRATE[which.max(df2$yield_h0.5)],
df2$HRATE[which.max(df2$yield_h0.7)],
df2$HRATE[which.max(df2$yield_h0.9)]),
'FB40' = c(0.07,0.09, 0.1))
row.names(df5) <- c("h = 0.5","h = 0.7","h = 0.9")
kable(df5)
